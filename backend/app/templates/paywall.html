{# backend/app/templates/paywall.html #}
{% extends "base.html" %}
{% block content %}

{# Pre√ßo com fallback seguro: se n√£o vier do backend, mant√©m 29,00 #}
{% set _price = paywall_price_brl if paywall_price_brl is defined and paywall_price_brl else "29,00" %}

<style>
.page-wrap{
  max-width: 980px;
  margin: 0 auto;
}

.shell{
  max-width: 780px;
  margin: 0 auto;
}

.hero{
  margin: 10px 0 14px 0;
  padding: 18px 18px;
  border: 1px solid #e5e7eb;
  border-radius: 16px;
  background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}

.hero h1{
  margin: 0 0 6px 0;
  font-size: 22px;
  font-weight: 900;
  letter-spacing: -0.2px;
}

.hero p{
  margin: 0;
  color: #4b5563;
  line-height: 1.5;
  font-size: 14px;
}

.status{
  margin-top: 12px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border-radius: 999px;
  padding: 7px 12px;
  font-size: 12px;
  font-weight: 900;
  color: #92400e;
  background: #fffbeb;
  border: 1px solid #fde68a;
}

.grid{
  display: grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap: 14px;
}

@media (max-width: 860px){
  .grid{ grid-template-columns: 1fr; }
}

.box{
  border: 1px solid #e5e7eb;
  border-radius: 16px;
  background: #ffffff;
  padding: 18px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.04);
}

.kicker{
  font-size: 11px;
  font-weight: 900;
  color: #6b7280;
  text-transform: uppercase;
  letter-spacing: .5px;
  margin-bottom: 10px;
}

.list{
  margin: 0;
  padding-left: 18px;
  line-height: 1.7;
  color: #111827;
  font-size: 14px;
}

.muted{
  color: #6b7280;
  font-size: 13px;
  line-height: 1.5;
  margin-top: 10px;
}

.hr{
  height: 1px;
  background: #e5e7eb;
  margin: 14px 0;
}

.price{
  font-size: 44px;
  font-weight: 900;
  margin: 6px 0 6px 0;
  letter-spacing: -0.5px;
  color: #111827;
}

.subprice{
  font-size: 13px;
  color: #4b5563;
  line-height: 1.4;
}

.badges{
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 10px;
}

.badge{
  display: inline-flex;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  font-weight: 800;
  color: #111827;
  background: #eef2ff;
  border: 1px solid #e0e7ff;
  padding: 6px 10px;
  border-radius: 999px;
}

.actions{
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-top: 12px;
}

.btn-primary{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  border: none;
  border-radius: 12px;
  padding: 12px 16px;
  font-weight: 900;
  font-size: 14px;
  cursor: pointer;
  background: #2563eb;
  color: #ffffff;
  min-width: 280px;
  text-align: center;
  box-shadow: 0 10px 20px rgba(37,99,235,0.18);
  transition: transform .12s ease;
  text-decoration: none;
}

.btn-primary:hover{ transform: translateY(-1px); }
.btn-primary:active{ transform: translateY(0); }

.btn-secondary{
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #e5e7eb;
  background: #ffffff;
  color: #111827;
  border-radius: 12px;
  padding: 12px 14px;
  font-weight: 900;
  font-size: 13px;
  cursor: pointer;
  text-decoration: none;
}

.btn-secondary:hover{ border-color: #cbd5e1; }

.smallnote{
  margin-top: 12px;
  font-size: 12px;
  color: #6b7280;
  line-height: 1.5;
}

/* ===== Planos ===== */
.plan-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 8px;
}

@media (max-width: 860px){
  .plan-grid{ grid-template-columns: 1fr; }
}

.plan{
  border: 1px solid #e5e7eb;
  border-radius: 16px;
  padding: 14px;
  background: #ffffff;
}

.plan h3{
  margin: 0 0 6px 0;
  font-size: 14px;
  font-weight: 900;
  color: #111827;
}

.plan .tag{
  display:inline-flex;
  align-items:center;
  gap:8px;
  font-size: 11px;
  font-weight: 900;
  padding: 5px 10px;
  border-radius: 999px;
  border: 1px solid #e5e7eb;
  background: #f8fafc;
  color:#111827;
  margin-bottom: 10px;
}

.plan ul{
  margin: 0;
  padding-left: 18px;
  line-height: 1.65;
  font-size: 13px;
  color:#111827;
}

.plan.pro{
  border-color: #dbeafe;
  background: linear-gradient(180deg, #ffffff 0%, #f8fbff 100%);
}

.plan.pro .tag{
  background:#eff6ff;
  border-color:#dbeafe;
  color:#1d4ed8;
}

.plan .price-mini{
  margin-top: 10px;
  font-size: 12px;
  color:#4b5563;
}
</style>

<div class="page-wrap">
  <div class="shell">

    <div class="hero">
      <h1>Ative o Pro e envie propostas que passam confian√ßa</h1>
      <p>Quando o cliente pede ‚Äúme manda a proposta‚Äù, voc√™ n√£o pode enviar algo com marca d‚Äô√°gua ou sem PDF profissional. Com o Pro, voc√™ baixa o PDF pronto e mant√©m hist√≥rico pra reaproveitar.</p>
      <div class="status">üîí Seu acesso Pro ainda n√£o est√° ativo</div>
    </div>

    {# Debug opcional: aparece s√≥ se o backend passar debug_payments=True #}
    {% if debug_payments %}
      <div class="box" style="margin-bottom: 14px; border-color:#bae6fd;">
        <div class="kicker">Debug</div>
        <div style="font-size: 13px;">
          <strong>DEBUG_PAYMENTS:</strong> user_id={{ user.id }}
          {% if checkout_url %}
            <div style="margin-top: 6px; font-size: 12px; opacity: .85; word-break: break-all;">
              checkout_url={{ checkout_url }}
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}

    <div class="grid">

      <!-- Esquerda: planos e benef√≠cios -->
      <div class="box">
        <div class="kicker">Planos</div>

        <div class="plan-grid">

          <div class="plan">
            <div class="tag">üü¢ Free</div>
            <h3>Para testar (limitado)</h3>
            <ul>
              <li><strong>2 propostas por m√™s</strong></li>
              <li><strong>Com marca d‚Äô√°gua</strong></li>
              <li><strong>Sem download de PDF profissional</strong></li>
            </ul>
            <div class="price-mini">Ideal pra conhecer ‚Äî mas n√£o para fechar com empresas exigentes.</div>
          </div>

          <div class="plan pro">
            <div class="tag">üîµ Pro</div>
            <h3>Para fechar com apar√™ncia profissional</h3>
            <ul>
              <li><strong>Propostas ilimitadas</strong></li>
              <li><strong>PDF profissional</strong> pronto pra enviar</li>
              <li><strong>Hist√≥rico completo</strong> pra reutilizar r√°pido</li>
              <li><strong>Sem marca d‚Äô√°gua</strong></li>
            </ul>
            <div class="price-mini"><strong>R$ {{ _price }}/m√™s</strong> ‚Ä¢ cancele quando quiser</div>
          </div>

        </div>

        <div class="hr"></div>

        <div class="kicker">Por que isso importa?</div>
        <ul class="list">
          <li><strong>Voc√™ responde em minutos</strong> quando pedem proposta ‚Äúpra hoje‚Äù</li>
          <li><strong>Passa mais seguran√ßa</strong> com um PDF com padr√£o de empresa</li>
          <li><strong>Evita retrabalho</strong> salvando hist√≥rico por cliente</li>
          <li><strong>Ajuda na decis√£o</strong> com clareza de escopo, prazo e investimento</li>
        </ul>

        <div class="hr"></div>

        <div class="kicker">Sua conta</div>
        <div style="font-size: 14px; font-weight: 900; color:#111827;">
          {{ user.email }}
        </div>

        <p class="muted">
          Em servi√ßos t√©cnicos (manuten√ß√£o, instala√ß√£o, obra, servi√ßos recorrentes), quem compra quer clareza e ‚Äúdocumento limpo‚Äù.
          O Pro deixa sua proposta pronta pra aprova√ß√£o ‚Äî sem improviso.
        </p>
      </div>

      <!-- Direita: pre√ßo + CTA -->
      <div class="box">
        <div class="kicker">Ativar Pro</div>

        <div class="price">R$ {{ _price }}</div>
        <div class="subprice">
          Assinatura mensal ‚Ä¢ Libera√ß√£o imediata ap√≥s confirma√ß√£o ‚Ä¢ Cancele quando quiser
        </div>

        <div class="badges">
          <span class="badge">üîí Pagamento seguro</span>
          <span class="badge">‚ö° Ativa√ß√£o r√°pida</span>
          <span class="badge">üìÑ PDF profissional</span>
        </div>

        <div class="actions">
          {% if checkout_url %}
            {# ‚úÖ N√ÉO anexar user_id aqui (j√° vai pronto do backend). Evita duplicar user_id=user_id=... #}
            <a class="btn-primary"
               href="{{ checkout_url }}"
               target="_blank"
               rel="noopener noreferrer">
              üîµ Ativar Pro agora (R$ {{ _price }}/m√™s)
            </a>
          {% else %}
            <button class="btn-primary" disabled style="opacity:.6; cursor:not-allowed;">
              Checkout indispon√≠vel
            </button>
          {% endif %}

          <a class="btn-secondary" href="/logout">Sair</a>
        </div>

        <div class="smallnote">
          ‚úÖ Voc√™ continua criando propostas no Free. O Pro libera PDF profissional, hist√≥rico completo e uso ilimitado.
        </div>
      </div>

    </div>

    <div class="box" style="margin-top: 14px;">
      <div class="kicker">Quando vale a pena?</div>
      <p style="margin:0; line-height:1.6; color:#111827; font-size:14px;">
        Quando o cliente pede proposta e voc√™ precisa enviar algo ‚Äúcom cara de empresa‚Äù ‚Äî sem marca d‚Äô√°gua e sem perder tempo reescrevendo tudo.
      </p>
    </div>

  </div>
</div>

{% endblock %}
