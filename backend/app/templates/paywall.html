{# backend/app/templates/paywall.html #}
{% extends "base.html" %}
{% block content %}

{% set _price = paywall_price_brl if paywall_price_brl is defined and paywall_price_brl else "29,00" %}
{% set reason = request.query_params.get("reason") if request else None %}

<style>
/* ================= EXISTENTE ================= */
.page-wrap{max-width:980px;margin:0 auto;}
.shell{max-width:780px;margin:0 auto;}
.hero{margin:10px 0 14px 0;padding:18px;border:1px solid #e5e7eb;border-radius:16px;background:linear-gradient(180deg,#ffffff 0%,#f8fafc 100%);box-shadow:0 1px 2px rgba(0,0,0,0.04);}
.hero h1{margin:0 0 6px 0;font-size:22px;font-weight:900;}
.hero p{margin:0;color:#4b5563;line-height:1.5;font-size:14px;}
.status{margin-top:12px;display:inline-flex;align-items:center;gap:8px;border-radius:999px;padding:7px 12px;font-size:12px;font-weight:900;color:#92400e;background:#fffbeb;border:1px solid #fde68a;}
.grid{display:grid;grid-template-columns:1.2fr 0.8fr;gap:14px;}
@media (max-width:860px){.grid{grid-template-columns:1fr;}}
.box{border:1px solid #e5e7eb;border-radius:16px;background:#ffffff;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,0.04);}
.kicker{font-size:11px;font-weight:900;color:#6b7280;text-transform:uppercase;margin-bottom:10px;}
.list{margin:0;padding-left:18px;line-height:1.7;color:#111827;font-size:14px;}
.muted{color:#6b7280;font-size:13px;line-height:1.5;margin-top:10px;}
.hr{height:1px;background:#e5e7eb;margin:14px 0;}
.price{font-size:44px;font-weight:900;margin:6px 0;color:#111827;}
.subprice{font-size:13px;color:#4b5563;}
.badges{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}
.badge{font-size:12px;font-weight:800;background:#eef2ff;border:1px solid #e0e7ff;padding:6px 10px;border-radius:999px;}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px;}
.btn-primary{border:none;border-radius:12px;padding:12px 16px;font-weight:900;font-size:14px;background:#2563eb;color:#ffffff;min-width:280px;text-align:center;text-decoration:none;box-shadow:0 10px 20px rgba(37,99,235,0.18);}
.btn-secondary{border:1px solid #e5e7eb;background:#ffffff;color:#111827;border-radius:12px;padding:12px 14px;font-weight:900;font-size:13px;text-decoration:none;}
.smallnote{margin-top:12px;font-size:12px;color:#6b7280;}
.plan-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:8px;}
@media (max-width:860px){.plan-grid{grid-template-columns:1fr;}}
.plan{border:1px solid #e5e7eb;border-radius:16px;padding:14px;background:#ffffff;}
.plan.pro{border-color:#dbeafe;background:linear-gradient(180deg,#ffffff 0%,#f8fbff 100%);}

/* ================= NOVO ALERTA ================= */
.alert-quota{
  margin-bottom:14px;
  padding:14px 16px;
  border-radius:12px;
  background:#fef3c7;
  border:1px solid #fde68a;
  color:#92400e;
  font-size:14px;
  font-weight:700;
}
.alert-quota strong{
  display:block;
  margin-bottom:4px;
}
</style>

<div class="page-wrap">
  <div class="shell">

    {% if reason == "quota" %}
      <div class="alert-quota">
        <strong>‚ö†Ô∏è Voc√™ atingiu o limite do plano Free</strong>
        Seu plano gratuito permite apenas <strong>2 propostas por m√™s</strong>.
        Fa√ßa upgrade para o Pro para gerar propostas ilimitadas e baixar o PDF profissional.
      </div>
    {% endif %}

    <div class="hero">
      <h1>Ative o Pro e envie propostas que passam confian√ßa</h1>
      <p>Com o Pro voc√™ gera propostas ilimitadas e baixa o PDF profissional pronto para enviar ao cliente.</p>
      <div class="status">üîí Seu acesso Pro ainda n√£o est√° ativo</div>
    </div>

    <div class="grid">

      <div class="box">
        <div class="kicker">Planos</div>

        <div class="plan-grid">
          <div class="plan">
            <h3>üü¢ Free</h3>
            <ul>
              <li><strong>2 propostas por m√™s</strong></li>
              <li>Com marca d‚Äô√°gua</li>
              <li>Sem PDF profissional</li>
            </ul>
          </div>

          <div class="plan pro">
            <h3>üîµ Pro</h3>
            <ul>
              <li><strong>Propostas ilimitadas</strong></li>
              <li>PDF profissional</li>
              <li>Hist√≥rico completo</li>
              <li>Sem marca d‚Äô√°gua</li>
            </ul>
            <div style="margin-top:10px;font-size:13px;">
              <strong>R$ {{ _price }}/m√™s</strong>
            </div>
          </div>
        </div>

        <div class="hr"></div>

        <div class="kicker">Sua conta</div>
        <div style="font-size:14px;font-weight:900;">{{ user.email }}</div>
      </div>

      <div class="box">
        <div class="kicker">Ativar Pro</div>

        <div class="price">R$ {{ _price }}</div>
        <div class="subprice">
          Assinatura mensal ‚Ä¢ Libera√ß√£o imediata ‚Ä¢ Cancele quando quiser
        </div>

        <div class="badges">
          <span class="badge">üîí Pagamento seguro</span>
          <span class="badge">‚ö° Ativa√ß√£o r√°pida</span>
          <span class="badge">üìÑ PDF profissional</span>
        </div>

        <div class="actions">
          {% if checkout_url %}
            <a class="btn-primary"
               href="{{ checkout_url }}"
               target="_blank"
               rel="noopener noreferrer">
              üîµ Ativar Pro agora (R$ {{ _price }}/m√™s)
            </a>
          {% else %}
            <button class="btn-primary" disabled>Checkout indispon√≠vel</button>
          {% endif %}

          <a class="btn-secondary" href="/logout">Sair</a>
        </div>

        <div class="smallnote">
          Voc√™ pode continuar usando o Free, mas o Pro libera gera√ß√£o ilimitada e PDF profissional.
        </div>
      </div>

    </div>

  </div>
</div>

{% endblock %}
